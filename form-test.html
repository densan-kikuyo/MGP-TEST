<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>ãŠã¿ã‚„ã’ã‚°ãƒ©ãƒ³ãƒ—ãƒª æŠ•ç¥¨</title>
  <style>
    /* ===== è¦‹ãŸç›®ï¼ˆãƒãƒƒãƒ—åŸºèª¿ï¼‰ ===== */
    :root{
      --bg:#fff7f0; --brand:#ffcf66; --accent:#27c3a9; --accent-d:#1ea18c; --pick:#ff7a7a;
    }
    html,body{margin:0;padding:0;background:var(--bg);color:#222;font-family:system-ui,-apple-system,"Hiragino Kaku Gothic ProN",Meiryo,sans-serif}
    header{padding:16px 20px;text-align:center;background:var(--brand);position:sticky;top:0;z-index:10;box-shadow:0 2px 0 rgba(0,0,0,.06)}
    header h1{margin:0;font-size:20px}
    .wrap{padding:16px;max-width:1100px;margin:0 auto}
    .note{margin:8px 0 16px;font-size:14px;color:#444}
    .grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
    @media(min-width:720px){.grid{grid-template-columns:repeat(3,1fr)}}
    @media(min-width:1024px){.grid{grid-template-columns:repeat(4,1fr)}}

    .card{background:#fff;border-radius:14px;overflow:hidden;border:3px solid transparent;position:relative;box-shadow:0 4px 0 rgba(0,0,0,.06)}
    .card button{all:unset;display:block;cursor:pointer}
    .card img{width:100%;height:150px;object-fit:cover;display:block}
    .label{padding:10px 12px;font-weight:700;text-align:center}
    .badge{position:absolute;top:8px;left:8px;background:#fff;border-radius:999px;padding:6px 10px;font-size:12px;box-shadow:0 2px 0 rgba(0,0,0,.08)}
    .selected{border-color:var(--pick)}
    .selected::after{content:"âœ“";position:absolute;right:8px;top:8px;background:var(--pick);color:#fff;width:28px;height:28px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:800;box-shadow:0 2px 0 rgba(0,0,0,.15)}

    .actions{position:sticky;bottom:0;background:linear-gradient(180deg,rgba(255,247,240,0),var(--bg) 40%);padding:16px}
    .btn{width:100%;font-size:18px;font-weight:800;padding:14px 18px;border:none;border-radius:12px;background:var(--accent);color:#fff;box-shadow:0 6px 0 var(--accent-d);transition:transform .05s}
    .btn:active{transform:translateY(2px);box-shadow:0 4px 0 var(--accent-d)}
    .btn[disabled]{background:#c7eae3;box-shadow:none;color:#6b6b6b}
    .counter{text-align:center;font-size:14px;margin:6px 0 0;color:#333}

    /* ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã®è»½é‡ãƒˆãƒ¼ã‚¹ãƒˆï¼ˆfetchç‰ˆç”¨ã ãŒPOSTç‰ˆã§ã‚‚ä¸€å¿œæ®‹ã™ï¼‰ */
    .toast{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.35);z-index:50}
    .toast>div{background:#fff;border-radius:16px;padding:28px 22px;text-align:center;width:min(90vw,420px);box-shadow:0 10px 0 rgba(0,0,0,.12)}
    .toast h2{margin:0 0 8px;font-size:22px}
    .toast p{margin:0;color:#555}
  </style>
</head>
<body>
  <header><h1>ğŸ¥• èŠé™½ç”ºãŠã¿ã‚„ã’ã‚°ãƒ©ãƒ³ãƒ—ãƒªï¼’ï¼ï¼’ï¼• æŠ•ç¥¨ ğŸŒŸ</h1></header>

  <div class="wrap">
    <p class="note">æ°—ã«å…¥ã£ãŸãŠã¿ã‚„ã’ã‚’ <b>æœ€å¤§3ã¤ã¾ã§</b> ã‚¿ãƒƒãƒ—ã—ã¦é¸ã‚“ã§ãã ã•ã„ã€‚</p>

    <div id="grid" class="grid"></div>

    <div class="actions">
      <button id="submitBtn" class="btn" disabled>æŠ•ç¥¨ï¼ï¼</button>
      <div class="counter"><span id="count">0</span>/3 é¸æŠä¸­</div>
    </div>
  </div>

  <!-- ãƒ•ã‚§ãƒ¼ãƒ«ã‚»ãƒ¼ãƒ•ç”¨ãƒˆãƒ¼ã‚¹ãƒˆï¼ˆPOSTé·ç§»ãŒåŸºæœ¬ãªã®ã§é€šå¸¸ã¯æœªä½¿ç”¨ï¼‰ -->
  <div id="thanks" class="toast" role="alertdialog" aria-live="assertive">
    <div>
      <h2>æŠ•ç¥¨ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸï¼ï¼ ğŸ‰</h2>
      <p>2ç§’å¾Œã«æœ€åˆã®ç”»é¢ã«æˆ»ã‚Šã¾ã™â€¦</p>
    </div>
  </div>

  <script>
    // =====================
    // è¨­ å®š
    // =====================
    // 1) GASã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã®/exec URL ã‚’è¨­å®šï¼ˆãƒ‡ãƒ—ãƒ­ã‚¤æ™‚ã«æ§ãˆãŸURLï¼‰
    const FORM_ENDPOINT = "https://script.google.com/a/macros/town.kikuyo.lg.jp/s/AKfycbyvGScEN5q3Pyq3V7jqzlTvYugsvBdTJ6RRHNW2BJS02vBKErr3j_wwjUSZ9G1oS-rn/exec"; // ä¾‹: https://script.google.com/macros/s/XXXX/exec

    // 2) ç«¯æœ«è­˜åˆ¥ï¼ˆiPadã”ã¨ã«å¤‰ãˆã‚‹ã¨é›†è¨ˆä¾¿åˆ©ï¼‰
    const DEVICE_ID = "iPad1";  // KIOSK_A / KIOSK_B / KIOSK_C â€¦

    // 3) åŒæ™‚é¸æŠä¸Šé™
    const MAX_SELECT = 3;

    // 4) å•†å“ãƒªã‚¹ãƒˆï¼ˆç”»åƒã¯ /images é…ä¸‹ã«ç½®ãæƒ³å®šï¼‰
    const ITEMS = [
      { id:"id_01", name:"A. ã‚³ãƒ¼ãƒ’ãƒ¼", img:"images/01.jpg" },
      { id:"id_02", name:"B. ã†ã©ã‚“",   img:"images/02.jpg" },
      { id:"id_03", name:"C. æ‹‰éºµ", img:"images/03.jpg" },
      { id:"id_04", name:"D. ãƒãƒ¼ã‚º", img:"images/04.jpg" },
      { id:"id_05", name:"E. ã‚«ãƒ¬ãƒ¼", img:"images/05.jpg" },
      { id:"id_06", name:"F. ã‚ã‚‰ã‚Œ", img:"images/06.jpg" },
      { id:"id_07", name:"G. æœˆé¤…", img:"images/07.jpg" },
      { id:"id_08", name:"H. ã‚¯ãƒƒã‚­ãƒ¼", img:"images/08.jpg" },
      { id:"id_09", name:"I. ã«ã‚“ã˜ã‚“ã‚¯ãƒƒã‚­ãƒ¼", img:"images/09.jpg" },
      { id:"id_10", name:"J. ã¿ã", img:"images/10.jpg" }
    ];
    // =====================

    const grid = document.getElementById('grid');
    const submitBtn = document.getElementById('submitBtn');
    const countEl = document.getElementById('count');
    const thanks = document.getElementById('thanks');
    let selected = new Set();

    function renderGrid(){
      grid.innerHTML = '';
      ITEMS.forEach((item, idx) => {
        const card = document.createElement('div');
        card.className = 'card';
        card.dataset.id = item.id;

        const btn = document.createElement('button');
        btn.onclick = () => toggleSelect(item.id, card);

        const img = document.createElement('img');
        img.src = item.img; img.alt = item.name;

        const label = document.createElement('div');
        label.className = 'label';
        label.textContent = item.name;

        const badge = document.createElement('div');
        badge.className = 'badge';
        badge.textContent = String.fromCharCode(0x2460 + idx); // â‘ â‘¡â‘¢â€¦

        btn.appendChild(img);
        btn.appendChild(label);
        card.appendChild(btn);
        card.appendChild(badge);
        grid.appendChild(card);
      });
    }

    function toggleSelect(id, cardEl){
      if (selected.has(id)) {
        selected.delete(id);
        cardEl.classList.remove('selected');
      } else {
        if (selected.size >= MAX_SELECT) {
          // 4ã¤ç›®ã¯ä¸å¯ï¼šè»½ã„æŒ¯å‹•æ¼”å‡º
          cardEl.animate([
            {transform:'translateY(0)'},
            {transform:'translateY(-3px)'},
            {transform:'translateY(0)'}
          ], {duration:120});
          return;
        }
        selected.add(id);
        cardEl.classList.add('selected');
      }
      updateUI();
    }

    function updateUI(){
      countEl.textContent = selected.size;
      submitBtn.disabled = (selected.size === 0);
    }

    submitBtn.addEventListener('click', () => {
      if (selected.size === 0) return;                // ä¿é™º
      postByForm(Array.from(selected), DEVICE_ID);    // â†’ GASï¼ˆ/execï¼‰ã¸ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«GET
    });
    
    // ===== ã“ã“ãŒã€Œçµ„ç¹”ãƒ­ã‚°ã‚¤ãƒ³å‰æç‰ˆã€ã®ã‚­ãƒ¢ =====
    // fetch ã§ã¯ãªãã€ãƒ•ã‚©ãƒ¼ãƒ POSTã§GASã¸ç”»é¢é·ç§»ã—ã¦é€ä¿¡
    function postByForm(choices, deviceId){
      const form = document.createElement('form');
      form.method = 'GET';
      form.action = FORM_ENDPOINT;  // GASã®/exec ã«é·ç§»
      form.style.display = 'none';

      const add = (k,v)=>{ const i=document.createElement('input'); i.type='hidden'; i.name=k; i.value=v; form.appendChild(i); };
      add('choices', choices.join(','));   // "id_01,id_02,id_05"
      add('device_id', deviceId);
      add('ua', navigator.userAgent);
      add('_', Date.now());                // â˜… ã‚­ãƒ£ãƒƒã‚·ãƒ¥å›é¿

      document.body.appendChild(form);
      form.submit(); // â†’ GASï¼ˆæ›¸ãè¾¼ã¿ï¼‰â†’ thanks.htmlï¼ˆGitHubï¼‰â†’ 1.8ç§’å¾Œ index
    }

    function resetForm(){
      selected.clear();
      document.querySelectorAll('.card').forEach(el => el.classList.remove('selected'));
      updateUI();
      window.scrollTo({ top:0, behavior:'smooth' });
    }

    renderGrid();
    updateUI();
  </script>
</body>

</html>






